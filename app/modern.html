<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ’° ãƒãƒ«ãƒã‚¦ã‚©ãƒ¬ãƒƒãƒˆåæ”¯ç®¡ç†</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .wallet-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      transition: all 0.3s ease;
    }
    .wallet-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    }
    .cash-card { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }
    .wallet-card.wallet { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .app-card { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .ic-card { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    
    .transaction-card {
      transition: all 0.2s ease;
      border-left: 4px solid transparent;
    }
    .transaction-card:hover {
      transform: translateX(4px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .transaction-income { border-left-color: #10b981; }
    .transaction-expense { border-left-color: #ef4444; }
    .transaction-transfer { border-left-color: #3b82f6; }
    
    .form-input {
      transition: all 0.2s ease;
      border: 2px solid #e5e7eb;
    }
    .form-input:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      transition: all 0.2s ease;
    }
    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }
    
    .stats-card {
      background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
  <div class="container mx-auto max-w-6xl p-6">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold text-gray-800 mb-2">ğŸ’° ãƒãƒ«ãƒã‚¦ã‚©ãƒ¬ãƒƒãƒˆåæ”¯ç®¡ç†</h1>
      <p class="text-gray-600">ç¾é‡‘ãƒ»è²¡å¸ƒãƒ»ã‚¢ãƒ—ãƒªãƒ»äº¤é€šç³»ICã‚’ä¸€æ‹¬ç®¡ç†</p>
    </div>
    
    <!-- ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ®‹é«˜ã‚«ãƒ¼ãƒ‰ -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <div class="wallet-card cash-card text-white p-6 rounded-xl shadow-lg">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold flex items-center">
            <span class="text-2xl mr-2">ğŸ’µ</span>ç¾é‡‘
          </h3>
          <button onclick="openEditModal('ç¾é‡‘')" class="text-white hover:text-gray-200">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
            </svg>
          </button>
        </div>
        <p class="text-3xl font-bold" id="cash-balance">Â¥0</p>
        <p class="text-sm opacity-80 mt-2">æ‰‹å…ƒã®ç¾é‡‘</p>
      </div>
      
      <div class="wallet-card wallet text-white p-6 rounded-xl shadow-lg">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold flex items-center">
            <span class="text-2xl mr-2">ğŸ‘›</span>è²¡å¸ƒ
          </h3>
          <button onclick="openEditModal('è²¡å¸ƒ')" class="text-white hover:text-gray-200">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
            </svg>
          </button>
        </div>
        <p class="text-3xl font-bold" id="wallet-balance">Â¥0</p>
        <p class="text-sm opacity-80 mt-2">è²¡å¸ƒã®ä¸­èº«</p>
      </div>
      
      <div class="wallet-card app-card text-white p-6 rounded-xl shadow-lg">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold flex items-center">
            <span class="text-2xl mr-2">ğŸ“±</span>ã‚¢ãƒ—ãƒª
          </h3>
          <button onclick="openEditModal('ã‚¢ãƒ—ãƒª')" class="text-white hover:text-gray-200">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
            </svg>
          </button>
        </div>
        <p class="text-3xl font-bold" id="app-balance">Â¥0</p>
        <p class="text-sm opacity-80 mt-2">æ±ºæ¸ˆã‚¢ãƒ—ãƒªæ®‹é«˜</p>
      </div>
      
      <div class="wallet-card ic-card text-white p-6 rounded-xl shadow-lg">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold flex items-center">
            <span class="text-2xl mr-2">ğŸš‡</span>äº¤é€šç³»IC
          </h3>
          <button onclick="openEditModal('äº¤é€šç³»IC')" class="text-white hover:text-gray-200">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
            </svg>
          </button>
        </div>
        <p class="text-3xl font-bold" id="ic-balance">Â¥0</p>
        <p class="text-sm opacity-80 mt-2">Suicaãƒ»PASMOç­‰</p>
      </div>
    </div>
    
    <!-- çµ±è¨ˆã‚µãƒãƒªãƒ¼ -->
    <div class="stats-card p-6 rounded-xl shadow-lg mb-8">
      <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
        <span class="text-2xl mr-2">ğŸ“Š</span>è²¡å‹™ã‚µãƒãƒªãƒ¼
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div class="text-center">
          <p class="text-sm text-gray-600 mb-1">ç·æ®‹é«˜</p>
          <p class="text-2xl font-bold text-blue-600" id="total-balance">Â¥0</p>
        </div>
        <div class="text-center">
          <p class="text-sm text-gray-600 mb-1">ä»Šæœˆã®åå…¥</p>
          <p class="text-2xl font-bold text-green-500" id="total-income">Â¥0</p>
        </div>
        <div class="text-center">
          <p class="text-sm text-gray-600 mb-1">ä»Šæœˆã®æ”¯å‡º</p>
          <p class="text-2xl font-bold text-red-500" id="total-expense">Â¥0</p>
        </div>
        <div class="text-center">
          <p class="text-sm text-gray-600 mb-1">åæ”¯</p>
          <p class="text-2xl font-bold text-purple-600" id="net-balance">Â¥0</p>
        </div>
      </div>
    </div>
    
    <!-- å–å¼•è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ  -->
    <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
      <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
        <span class="text-2xl mr-2">â•</span>æ–°ã—ã„å–å¼•ã‚’è¿½åŠ 
      </h3>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“… æ—¥ä»˜</label>
          <input type="date" id="date-input" class="form-input w-full p-3 rounded-lg outline-none">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ’° é‡‘é¡ï¼ˆå††ï¼‰</label>
          <input type="number" id="amount-input" class="form-input w-full p-3 rounded-lg outline-none" min="1" placeholder="1000">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“ èª¬æ˜ <span class="text-gray-400 text-xs">(ä»»æ„)</span></label>
          <input type="text" id="description-input" class="form-input w-full p-3 rounded-lg outline-none" placeholder="ã‚³ãƒ³ãƒ“ãƒ‹ã§è²·ã„ç‰© (ç©ºæ¬„å¯)">
        </div>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ”„ å–å¼•ã‚¿ã‚¤ãƒ—</label>
          <select id="type-select" class="form-input w-full p-3 rounded-lg outline-none" onchange="toggleTransferFields()">
            <option value="expense">ğŸ’¸ æ”¯å‡º</option>
            <option value="income">ğŸ’µ åå…¥</option>
            <option value="transfer">ğŸ”„ ã‚¦ã‚©ãƒ¬ãƒƒãƒˆé–“é€é‡‘</option>
          </select>
        </div>
        
        <div id="category-field">
          <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ·ï¸ ã‚«ãƒ†ã‚´ãƒªãƒ¼</label>
          <select id="category-select" class="form-input w-full p-3 rounded-lg outline-none">
            <option value="é£Ÿè²»">ğŸ½ï¸ é£Ÿè²»</option>
            <option value="ä½å±…è²»">ğŸ  ä½å±…è²»</option>
            <option value="äº¤é€šè²»">ğŸšŒ äº¤é€šè²»</option>
            <option value="å…‰ç†±è²»">ğŸ’¡ å…‰ç†±è²»</option>
            <option value="é€šä¿¡è²»">ğŸ“ é€šä¿¡è²»</option>
            <option value="å¨¯æ¥½è²»">ğŸ® å¨¯æ¥½è²»</option>
            <option value="åŒ»ç™‚è²»">ğŸ¥ åŒ»ç™‚è²»</option>
            <option value="ãã®ä»–æ”¯å‡º">ğŸ“¦ ãã®ä»–æ”¯å‡º</option>
          </select>
        </div>
        
        <div id="wallet-field">
          <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ‘› ã‚¦ã‚©ãƒ¬ãƒƒãƒˆ</label>
          <select id="wallet-select" class="form-input w-full p-3 rounded-lg outline-none">
            <option value="ç¾é‡‘">ğŸ’µ ç¾é‡‘</option>
            <option value="è²¡å¸ƒ">ğŸ‘› è²¡å¸ƒ</option>
            <option value="ã‚¢ãƒ—ãƒª">ğŸ“± ã‚¢ãƒ—ãƒª</option>
            <option value="äº¤é€šç³»IC">ğŸš‡ äº¤é€šç³»IC</option>
          </select>
        </div>
        
        <div id="transfer-from-field" style="display: none;">
          <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“¤ é€é‡‘å…ƒ</label>
          <select id="transfer-from-select" class="form-input w-full p-3 rounded-lg outline-none" onchange="updateTransferToOptions()">
            <option value="ç¾é‡‘">ğŸ’µ ç¾é‡‘</option>
            <option value="è²¡å¸ƒ">ğŸ‘› è²¡å¸ƒ</option>
            <option value="ã‚¢ãƒ—ãƒª">ğŸ“± ã‚¢ãƒ—ãƒª</option>
            <option value="äº¤é€šç³»IC">ğŸš‡ äº¤é€šç³»IC</option>
          </select>
        </div>
        
        <div id="transfer-to-field" style="display: none;">
          <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“¥ é€é‡‘å…ˆ</label>
          <select id="transfer-to-select" class="form-input w-full p-3 rounded-lg outline-none">
            <option value="è²¡å¸ƒ">ğŸ‘› è²¡å¸ƒ</option>
            <option value="ã‚¢ãƒ—ãƒª">ğŸ“± ã‚¢ãƒ—ãƒª</option>
            <option value="äº¤é€šç³»IC">ğŸš‡ äº¤é€šç³»IC</option>
          </select>
        </div>
      </div>
      
      <button onclick="addTransaction()" class="btn-primary w-full py-3 px-6 text-white font-medium rounded-lg outline-none">
        âœ¨ å–å¼•ã‚’è¿½åŠ 
      </button>
    </div>
    
    <!-- å–å¼•å±¥æ­´ -->
    <div class="bg-white p-6 rounded-xl shadow-lg">
      <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-6">
        <h3 class="text-xl font-bold text-gray-800 mb-4 md:mb-0 flex items-center">
          <span class="text-2xl mr-2">ğŸ“‹</span>å–å¼•å±¥æ­´
        </h3>
        
        <div class="flex space-x-3">
          <select id="filter-type" class="form-input p-2 rounded-lg text-sm outline-none" onchange="filterTransactions()">
            <option value="all">ã™ã¹ã¦ã®ã‚¿ã‚¤ãƒ—</option>
            <option value="income">ğŸ’µ åå…¥ã®ã¿</option>
            <option value="expense">ğŸ’¸ æ”¯å‡ºã®ã¿</option>
            <option value="transfer">ğŸ”„ é€é‡‘ã®ã¿</option>
          </select>
          
          <select id="filter-wallet" class="form-input p-2 rounded-lg text-sm outline-none" onchange="filterTransactions()">
            <option value="all">ã™ã¹ã¦ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆ</option>
            <option value="ç¾é‡‘">ğŸ’µ ç¾é‡‘</option>
            <option value="è²¡å¸ƒ">ğŸ‘› è²¡å¸ƒ</option>
            <option value="ã‚¢ãƒ—ãƒª">ğŸ“± ã‚¢ãƒ—ãƒª</option>
            <option value="äº¤é€šç³»IC">ğŸš‡ äº¤é€šç³»IC</option>
          </select>
        </div>
      </div>
      
      <div id="transactions-list" class="space-y-3">
        <div class="text-center text-gray-500 py-8">
          <span class="text-4xl">ğŸ“</span>
          <p class="mt-2">å–å¼•ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</p>
          <p class="text-sm">ä¸Šã®ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰å–å¼•ã‚’è¿½åŠ ã—ã¦ãã ã•ã„</p>
        </div>
      </div>
    </div>
  </div>
  
  <!-- æ®‹é«˜ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div id="edit-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white p-6 rounded-xl shadow-xl max-w-md w-full mx-4">
      <h3 class="text-lg font-bold text-gray-800 mb-4" id="modal-title">æ®‹é«˜ã‚’ç·¨é›†</h3>
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700 mb-2">æ–°ã—ã„æ®‹é«˜ï¼ˆå††ï¼‰</label>
        <input type="number" id="modal-balance-input" class="form-input w-full p-3 rounded-lg outline-none">
      </div>
      <div class="flex space-x-3">
        <button onclick="closeEditModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors">
          ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        </button>
        <button onclick="updateBalance()" class="flex-1 btn-primary text-white py-2 px-4 rounded-lg">
          æ›´æ–°
        </button>
      </div>
    </div>
  </div>

  <script>
    let wallets = { ç¾é‡‘: 0, è²¡å¸ƒ: 0, ã‚¢ãƒ—ãƒª: 0, äº¤é€šç³»IC: 0 };
    let transactions = [];
    let currentEditWallet = '';
    
    // ã‚¢ã‚¤ã‚³ãƒ³ãƒãƒƒãƒ”ãƒ³ã‚°
    const walletIcons = {
      'ç¾é‡‘': 'ğŸ’µ',
      'è²¡å¸ƒ': 'ğŸ‘›', 
      'ã‚¢ãƒ—ãƒª': 'ğŸ“±',
      'äº¤é€šç³»IC': 'ğŸš‡'
    };
    
    const categoryIcons = {
      'é£Ÿè²»': 'ğŸ½ï¸', 'ä½å±…è²»': 'ğŸ ', 'äº¤é€šè²»': 'ğŸšŒ', 'å…‰ç†±è²»': 'ğŸ’¡',
      'é€šä¿¡è²»': 'ğŸ“', 'å¨¯æ¥½è²»': 'ğŸ®', 'åŒ»ç™‚è²»': 'ğŸ¥', 'ãã®ä»–æ”¯å‡º': 'ğŸ“¦',
      'çµ¦æ–™': 'ğŸ’¼', 'ãƒœãƒ¼ãƒŠã‚¹': 'ğŸ', 'ãã®ä»–åå…¥': 'ğŸ’°', 'é€é‡‘': 'ğŸ”„'
    };
    
    // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ãƒ»ä¿å­˜
    function loadData() {
      const savedWallets = localStorage.getItem('wallets');
      const savedTransactions = localStorage.getItem('transactions');
      
      if (savedWallets) wallets = JSON.parse(savedWallets);
      if (savedTransactions) transactions = JSON.parse(savedTransactions);
      
      updateDisplay();
    }
    
    function saveData() {
      localStorage.setItem('wallets', JSON.stringify(wallets));
      localStorage.setItem('transactions', JSON.stringify(transactions));
    }
    
    // è¡¨ç¤ºæ›´æ–°
    function updateDisplay() {
      // ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ®‹é«˜æ›´æ–°
      document.getElementById('cash-balance').textContent = 'Â¥' + wallets['ç¾é‡‘'].toLocaleString();
      document.getElementById('wallet-balance').textContent = 'Â¥' + wallets['è²¡å¸ƒ'].toLocaleString();
      document.getElementById('app-balance').textContent = 'Â¥' + wallets['ã‚¢ãƒ—ãƒª'].toLocaleString();
      document.getElementById('ic-balance').textContent = 'Â¥' + wallets['äº¤é€šç³»IC'].toLocaleString();
      
      // çµ±è¨ˆæ›´æ–°
      const totalBalance = Object.values(wallets).reduce((sum, balance) => sum + balance, 0);
      const totalIncome = transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
      const totalExpense = transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
      
      document.getElementById('total-balance').textContent = 'Â¥' + totalBalance.toLocaleString();
      document.getElementById('total-income').textContent = 'Â¥' + totalIncome.toLocaleString();
      document.getElementById('total-expense').textContent = 'Â¥' + totalExpense.toLocaleString();
      document.getElementById('net-balance').textContent = 'Â¥' + (totalIncome - totalExpense).toLocaleString();
      
      // æ®‹é«˜ã‚«ãƒ¼ãƒ‰ã®è‰²æ›´æ–°
      updateWalletCardColors();
      
      // å–å¼•å±¥æ­´æ›´æ–°
      filterTransactions();
    }
    
    function updateWalletCardColors() {
      const balances = [
        { id: 'cash-balance', balance: wallets['ç¾é‡‘'] },
        { id: 'wallet-balance', balance: wallets['è²¡å¸ƒ'] },
        { id: 'app-balance', balance: wallets['ã‚¢ãƒ—ãƒª'] },
        { id: 'ic-balance', balance: wallets['äº¤é€šç³»IC'] }
      ];
      
      balances.forEach(({ id, balance }) => {
        const element = document.getElementById(id);
        element.className = balance < 0 ? 'text-3xl font-bold text-red-200' : 'text-3xl font-bold';
      });
    }
    
    // ãƒ¢ãƒ¼ãƒ€ãƒ«é–¢é€£
    function openEditModal(walletName) {
      currentEditWallet = walletName;
      document.getElementById('modal-title').textContent = `${walletIcons[walletName]} ${walletName} ã®æ®‹é«˜ã‚’ç·¨é›†`;
      document.getElementById('modal-balance-input').value = wallets[walletName];
      document.getElementById('edit-modal').classList.remove('hidden');
      document.getElementById('edit-modal').classList.add('flex');
    }
    
    function closeEditModal() {
      document.getElementById('edit-modal').classList.add('hidden');
      document.getElementById('edit-modal').classList.remove('flex');
    }
    
    function updateBalance() {
      const newBalance = parseFloat(document.getElementById('modal-balance-input').value) || 0;
      wallets[currentEditWallet] = newBalance;
      saveData();
      updateDisplay();
      closeEditModal();
    }
    
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆèª¬æ˜ç”Ÿæˆ
    function getDefaultDescription(type, wallet, transferTo = null) {
      if (type === 'transfer') {
        return `${walletIcons[wallet]}${wallet} ã‹ã‚‰ ${walletIcons[transferTo]}${transferTo} ã¸é€é‡‘`;
      } else {
        const category = document.getElementById('category-select').value;
        if (type === 'income') {
          return `${categoryIcons[category] || 'ğŸ’°'}${category}`;
        } else {
          return `${categoryIcons[category] || 'ğŸ’¸'}${category}`;
        }
      }
    }
    
    // å–å¼•é–¢é€£
    function toggleTransferFields() {
      const type = document.getElementById('type-select').value;
      const categoryField = document.getElementById('category-field');
      const walletField = document.getElementById('wallet-field');
      const transferFromField = document.getElementById('transfer-from-field');
      const transferToField = document.getElementById('transfer-to-field');
      
      if (type === 'transfer') {
        categoryField.style.display = 'none';
        walletField.style.display = 'none';
        transferFromField.style.display = 'block';
        transferToField.style.display = 'block';
        updateTransferToOptions();
      } else {
        categoryField.style.display = 'block';
        walletField.style.display = 'block';
        transferFromField.style.display = 'none';
        transferToField.style.display = 'none';
        
        // ã‚«ãƒ†ã‚´ãƒªãƒ¼æ›´æ–°
        const categorySelect = document.getElementById('category-select');
        categorySelect.innerHTML = '';
        
        const categories = type === 'income' 
          ? [['çµ¦æ–™', 'ğŸ’¼'], ['ãƒœãƒ¼ãƒŠã‚¹', 'ğŸ'], ['ãã®ä»–åå…¥', 'ğŸ’°']]
          : [['é£Ÿè²»', 'ğŸ½ï¸'], ['ä½å±…è²»', 'ğŸ '], ['äº¤é€šè²»', 'ğŸšŒ'], ['å…‰ç†±è²»', 'ğŸ’¡'], 
             ['é€šä¿¡è²»', 'ğŸ“'], ['å¨¯æ¥½è²»', 'ğŸ®'], ['åŒ»ç™‚è²»', 'ğŸ¥'], ['ãã®ä»–æ”¯å‡º', 'ğŸ“¦']];
             
        categories.forEach(([cat, icon]) => {
          const option = document.createElement('option');
          option.value = cat;
          option.textContent = `${icon} ${cat}`;
          categorySelect.appendChild(option);
        });
      }
    }
    
    function updateTransferToOptions() {
      const transferFrom = document.getElementById('transfer-from-select').value;
      const transferToSelect = document.getElementById('transfer-to-select');
      
      // é€é‡‘å…ˆã®é¸æŠè‚¢ã‚’æ›´æ–°ï¼ˆé€é‡‘å…ƒä»¥å¤–ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆï¼‰
      const allWallets = [
        ['ç¾é‡‘', 'ğŸ’µ'],
        ['è²¡å¸ƒ', 'ğŸ‘›'],
        ['ã‚¢ãƒ—ãƒª', 'ğŸ“±'],
        ['äº¤é€šç³»IC', 'ğŸš‡']
      ];
      
      transferToSelect.innerHTML = '';
      
      allWallets.forEach(([wallet, icon]) => {
        if (wallet !== transferFrom) {
          const option = document.createElement('option');
          option.value = wallet;
          option.textContent = `${icon} ${wallet}`;
          transferToSelect.appendChild(option);
        }
      });
    }
    
    function addTransaction() {
      const date = document.getElementById('date-input').value;
      const description = document.getElementById('description-input').value;
      const amount = parseFloat(document.getElementById('amount-input').value);
      const type = document.getElementById('type-select').value;
      
      if (!date || !amount || amount <= 0) {
        alert('æ—¥ä»˜ã¨é‡‘é¡ã¯å¿…é ˆã§ã™');
        return;
      }
      
      let wallet, transferTo;
      
      if (type === 'transfer') {
        wallet = document.getElementById('transfer-from-select').value;
        transferTo = document.getElementById('transfer-to-select').value;
        
        if (wallet === transferTo) {
          alert('é€é‡‘å…ƒã¨é€é‡‘å…ˆãŒåŒã˜ã§ã™');
          return;
        }
      } else {
        wallet = document.getElementById('wallet-select').value;
      }
      
      const transaction = {
        id: Date.now(),
        date,
        description: description || getDefaultDescription(type, wallet, transferTo),
        amount,
        type,
        wallet
      };
      
      if (type === 'transfer') {
        transaction.transferTo = transferTo;
        transaction.category = 'é€é‡‘';
        
        wallets[wallet] -= amount;
        wallets[transferTo] += amount;
      } else {
        transaction.category = document.getElementById('category-select').value;
        
        if (type === 'income') {
          wallets[wallet] += amount;
        } else {
          wallets[wallet] -= amount;
        }
      }
      
      transactions.unshift(transaction);
      saveData();
      updateDisplay();
      
      // ãƒ•ã‚©ãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ
      document.getElementById('description-input').value = '';
      document.getElementById('amount-input').value = '';
    }
    
    function deleteTransaction(id) {
      const transaction = transactions.find(t => t.id === id);
      
      if (transaction.type === 'income') {
        wallets[transaction.wallet] -= transaction.amount;
      } else if (transaction.type === 'expense') {
        wallets[transaction.wallet] += transaction.amount;
      } else if (transaction.type === 'transfer') {
        wallets[transaction.wallet] += transaction.amount;
        wallets[transaction.transferTo] -= transaction.amount;
      }
      
      transactions = transactions.filter(t => t.id !== id);
      saveData();
      updateDisplay();
    }
    
    function filterTransactions() {
      const typeFilter = document.getElementById('filter-type').value;
      const walletFilter = document.getElementById('filter-wallet').value;
      
      let filtered = [...transactions];
      
      if (typeFilter !== 'all') {
        filtered = filtered.filter(t => t.type === typeFilter);
      }
      
      if (walletFilter !== 'all') {
        filtered = filtered.filter(t => 
          t.wallet === walletFilter || 
          (t.type === 'transfer' && t.transferTo === walletFilter)
        );
      }
      
      updateTransactionsList(filtered);
    }
    
    function updateTransactionsList(filteredTransactions = transactions) {
      const container = document.getElementById('transactions-list');
      
      if (filteredTransactions.length === 0) {
        container.innerHTML = `
          <div class="text-center text-gray-500 py-8">
            <span class="text-4xl">ğŸ“</span>
            <p class="mt-2">å–å¼•ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</p>
            <p class="text-sm">ä¸Šã®ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰å–å¼•ã‚’è¿½åŠ ã—ã¦ãã ã•ã„</p>
          </div>
        `;
        return;
      }
      
      let html = '';
      filteredTransactions.forEach(t => {
        const icon = categoryIcons[t.category] || 'ğŸ“¦';
        const typeClass = `transaction-${t.type}`;
        const colorClass = t.type === 'income' ? 'text-green-500' : t.type === 'expense' ? 'text-red-500' : 'text-blue-500';
        const sign = t.type === 'income' ? '+' : t.type === 'expense' ? '-' : '';
        const walletDisplay = t.type === 'transfer' 
          ? `${walletIcons[t.wallet]} ${t.wallet} â†’ ${walletIcons[t.transferTo]} ${t.transferTo}`
          : `${walletIcons[t.wallet]} ${t.wallet}`;
        
        html += `
          <div class="transaction-card ${typeClass} bg-gray-50 p-4 rounded-lg">
            <div class="flex justify-between items-start">
              <div class="flex-1">
                <div class="flex items-center mb-2">
                  <span class="text-xl mr-2">${icon}</span>
                  <h4 class="font-semibold text-gray-800">${t.description}</h4>
                </div>
                <div class="text-sm text-gray-600 space-y-1">
                  <p>ğŸ“… ${t.date}</p>
                  <p>ğŸ·ï¸ ${t.category}</p>
                  <p>ğŸ‘› ${walletDisplay}</p>
                </div>
              </div>
              <div class="text-right">
                <p class="text-xl font-bold ${colorClass} mb-2">
                  ${sign}Â¥${t.amount.toLocaleString()}
                </p>
                <button onclick="deleteTransaction(${t.id})" class="text-red-400 hover:text-red-600 text-sm">
                  ğŸ—‘ï¸ å‰Šé™¤
                </button>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }
    
    // åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('date-input').value = new Date().toISOString().slice(0, 10);
      loadData();
    });
  </script>
</body>
</html>
